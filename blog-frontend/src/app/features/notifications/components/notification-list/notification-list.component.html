<div class="notifications-container">
  <!-- Header -->
  <div class="notifications-header">
    <div class="header-content">
      <h1 class="page-title">Notifications</h1>
      <span class="unread-badge">{{ unreadCount() }}</span>
    </div>

    <div class="header-actions">
      <!-- <button mat-icon-button (click)="refreshNotifications()" matTooltip="Refresh">
        <mat-icon>refresh</mat-icon>
      </button> -->

      <button
        mat-button
        (click)="onMarkAllAsRead()"
        class="mark-all-btn"
        [disabled]="unreadCount() === 0"
      >
        <mat-icon>done_all</mat-icon>
        {{ unreadCount() === 0 ? 'All read' : 'Mark all as read' }}
        <!-- Mark all as read -->
      </button>
    </div>
  </div>

  <!-- Loading State -->
  @if (isLoading() && notifications().length === 0) {
  <div class="loading-state">
    <mat-spinner diameter="48"></mat-spinner>
    <p>Loading notifications...</p>
  </div>
  }

  <!-- Empty State -->
  @if (!isLoading() && notifications().length === 0) {
  <div class="empty-state">
    <mat-icon class="empty-icon">notifications_none</mat-icon>
    <h2>No notifications yet</h2>
    <p>When you get notifications, they'll show up here.</p>
  </div>
  }

  <!-- Notifications Tabs -->
  @if (notifications().length > 0) {
  <div class="notifications-content">
    <mat-tab-group class="notifications-tabs" animationDuration="300ms">
      <!-- All Notifications Tab -->
      <mat-tab>
        <ng-template matTabLabel>
          <span class="tab-label">All</span>
          <!-- <span class="tab-count">{{ notifications().length }}</span> -->
        </ng-template>

        <div class="notifications-list">
          @for (notification of notifications(); track notification.id) {
          <app-notification-item
            [notification]="notification"
            (clicked)="onNotificationClick($event)"
            (markAsRead)="onMarkAsRead($event)"
            (delete)="onDelete($event)"
          >
          </app-notification-item>
          <mat-divider></mat-divider>
          @if (notification == notifications()[notifications().length - 1]) {
          <div #loadTrigger class="load-trigger"></div>
          @defer (on viewport(loadTrigger)) {
          {{ onTriggerVisible() }}
          } @placeholder {
          <div class="load-more-indicator">
            <mat-spinner diameter="32"></mat-spinner>
            <p>Loading more posts...</p>
          </div>
          } } 
        }
        </div>
      </mat-tab>
    </mat-tab-group>
  </div>
  }
</div>
